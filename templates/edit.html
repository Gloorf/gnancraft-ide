{% extends "base.html" %}

{% block content %}
    {% if logged_in_player %}
        <p>You are logged in as <em>{{ logged_in_player }}</em>
        (<a href="/logout">Log out</a>)</p>
    {% endif %}
    <h1>Browse JavaScript files</h1>

{% if ownedFiles%}
<p> You can edit one of the following files: </p> 
<ul>
    {%- for path in ownedFiles %}
      <li><a href="{{path}}">{{path}}</a></li>
    {%endfor %}
</ul>
{% elif logged_in_player %}
    {{playerDir}}<input type="text" data-url="{{playerDir}}"></input>
{% endif %}
<p> You can read the following files: </p> 
<ul>
  {%- for directory, files in filesByDirectory.iteritems()|sort %}
    {%- for path in files|sort %}
      <li><a href="{{path}}">{{path}}</a></li>
    {%endfor %}
  {%endfor %}
<script type="text/javascript">
  document.onkeyup = function(event) {
    if (event.keyCode != 13) return;
    var filename = event.target.value;
    function endsWith(str, suffix) {
        return str.indexOf(suffix, str.length - suffix.length) !== -1;
    }
    if (! endsWith(filename,".js")) {
      filename = filename + ".js";
    }
    window.location = event.target.dataset.url.slice(1) + filename;
  }
</script>

</ul> 
{% endblock %}
