<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Editing {{fname}}</title>

    <style type="text/css" media="screen">
    body {
        overflow: hidden;
    }
    #editor { 
        margin: 0;
        position: absolute;
        top: 120;
        bottom: 0;
        left: 0;
        right: 0;
    }
    </style>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
    </script>
  </head>

  <body>
<p><b>Editing {{fname}}</b></p>



{% if can_save %}
<p> <a href="/edit/">Back</a>
<input type='button' onclick='submitText()' value='Save'/>
</p>
{% endif %}
<p id="status">
{% if not can_save %}
You can't change this file.
{% else %}
File is unmodified
{% endif %}
</p>



<form name="editform" id="editform" action="/edit/{{fname}}" method="POST">
<input type="hidden" id="form_text" name="text" value="">
</form>

<pre id="editor">{{content}}
</pre>



<script src="http://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript">
function submitText()
{
   var txt=editor.getValue();
   var action = document.getElementById("editform").action;
   jQuery.post(action, { text : txt }, 
      function(data, txtStatus) {
         document.getElementById("status").innerHTML = "File is saved";
      }
   );
}

var editor = ace.edit("editor");
{% if not can_save %}
editor.setReadOnly(true);
{% endif %}
editor.setTheme("ace/theme/twilight");
editor.getSession().setMode("ace/mode/javascript");
document.getElementById('editor').style.fontSize='18px';

editor.getSession().on('change', function(e) {
   document.getElementById("status").innerHTML = "File is modified";     
});
</script>

  </body>
</html>
